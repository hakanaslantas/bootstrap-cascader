{"version":3,"sources":["js/bootstrap-cascader.js"],"names":["$","DEF_OPTS","splitChar","cls","btnCls","placeHolder","dropUp","lazy","openOnHover","openOnHoverDelay","openOnHoverDelay4Lazy","isSelectable","item","loaded","children","length","selectable","TPLS","enHtml","value","String","replace","DropdownPanel","data","csd","panel","this","selectItem","itemEl","params","call","setItemOpened","panelEl","removeClass","addClass","selectItemByCode","code","trigger","setSelected","setOpen","c","scrollToOpened","isMatchedSelectedItems","withParents","currItem","j","level","selectedItem","selectedItems","selectedItemCode","currItemData","originData","parent","find","size","scrollTop","top","position","height","destroy","removeData","remove","handler","itemCode","loadingItem","loadData","then","refreshPanels","always","appendTo","el","lastPanel","panels","lastPanelEl","lastPanelLeft","Number","css","left","outerWidth","push","isParentAllMatched","hasMatchedChildren","each","i","itemData","itemName","name","n","attr","text","on","selectItem click","openDropdown","openTimeout","clearTimeout","setTimeout","inited","reloaded","isInited","reloading","Cascader","def","initialized","readonly","Array","convertData2Col","isLazy","d","childMap","hasChild","updateBtnText","btn","getValue","htmlClickHandler","e","hasClass","cascader","target","parents","close","setValue","clearValue","names","oldSelectedItems","join","updateViewBySelected","tryFireOnChange","panelNo","rmPanels","splice","rmPanel","off","unshift","newItems","oldItems","fire","allCodesSame","oldItem","oldItemCode","newItem","open","toggleClass","slice","setReadonly","isReadonly","reload","openedItems","defered","Deferred","resolve","reject","promise","cols","insertAfter","hide","click","preventDefault","stopPropagation","fn","bsCascader","args","arguments","$this","extend","val","split","apply","prototype","jQuery"],"mappings":"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","file":"bootstrap-cascader.min.js","sourcesContent":["(function ($) {\n  'use strict';\n\n  // DEF_OPTS\n  var DEF_OPTS = {\n    splitChar: ' ',\n    cls: '',\n    btnCls: 'btn-default',\n    placeHolder: '请选择',\n    dropUp: false,\n    lazy: false,\n    openOnHover: false,\n    openOnHoverDelay: 100,\n    openOnHoverDelay4Lazy: 200,\n    isSelectable: function (item) {\n      return item && item.loaded && (!item.children || item.children.length <= 0 || item.selectable);\n    }\n  };\n\n  // TPLS\n  var TPLS = {\n    containerTpl: '<div class=\"btn-group bootstrap-cascader form-control\"></div>',\n    btnTpl: '<button class=\"btn dropdown-toggle bs-placeholder\" type=\"button\">\\\n        <span class=\"filter-option pull-left\"></span> <span class=\"caret icon-arrow-down\"></span> <span class=\"icon-cross bsfont icon-jiaochacross78\"></span>\\\n      </button>',\n    dropdownTpl: '<ul class=\"dropdown-menu\"></ul>',\n    dropdownItemTpl: '<li>\\\n        <a href=\"javascript:\">\\\n          <span class=\"text\"></span>\\\n          <span class=\"bsfont icon-ico-right-arrow item-right-arrow\"></span>\\\n          <span class=\"bsfont icon-loading item-loading\"></span>\\\n          <span class=\"bsfont icon-error\"></span>\\\n        </a>\\\n      </li>'\n  };\n\n  var enHtml = function (value) {\n    return !value ? '' : String(value).replace(/&/g, \"&amp;\").replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\");\n  };\n\n  // DropdownPanel\n  var DropdownPanel = function (data, csd) {\n    if (!data || !data.children || data.children.length <= 0) return;\n\n    var panel = this;\n    this.selectItem = function (item, itemEl) {\n      var selectable = csd.params.isSelectable.call(csd, item);\n      if (selectable) csd.selectItem(itemEl);\n    };\n\n    this.setItemOpened = function (item, itemEl) {\n      panel.panelEl.children('li').removeClass('open');\n      itemEl.addClass('open');\n      if (item.loaded && item.children.length == 0) itemEl.addClass('no-child');\n    };\n\n    this.selectItemByCode = function (code) {\n      panel.panelEl.children('li[code=' + enHtml(code) + ']').trigger('selectItem');\n    };\n\n    this.setSelected = function (item, setOpen) {\n      var itemEl = panel.panelEl.children('li[code=' + enHtml(item.code || item.c) + ']');\n      itemEl.children('a').addClass('selected');\n      if (setOpen) panel.setItemOpened(item, itemEl);\n      panel.scrollToOpened();\n    };\n\n    this.isMatchedSelectedItems = function (item, withParents) {\n      var currItem = item;\n      for (var j = item.level - 1; j >= 0; j--) {\n        var selectedItem = csd.selectedItems[j], selectedItemCode = selectedItem.code || selectedItem.c;\n        var currItemData = currItem.originData, currItemCode = currItemData.code || currItemData.c;\n        if (selectedItemCode != currItemCode) return false;\n        if (withParents === false) return true;\n        currItem = currItem.parent;\n      }\n      return true;\n    };\n\n    this.scrollToOpened = function () {\n      var panelEl = panel.panelEl, selectedItem = panelEl.find('li a.selected').parent();\n      if (selectedItem.size() > 0) {\n        var scrollTop = panelEl.scrollTop(), top = selectedItem.position().top + scrollTop;\n        if (scrollTop < top) {\n          top = top - (panelEl.height() - selectedItem.height()) / 2;\n          panelEl.scrollTop(top);\n        }\n      }\n    };\n\n    this.destroy = function () {\n      panel.panelEl.children('li').removeData('cascaderItem');\n      panel.panelEl.remove();\n    };\n\n    var handler = function (item, itemEl, selectItem) {\n      if (csd.params.lazy && item.loaded === false) {\n        itemEl.addClass('bs-loading');\n        var itemCode = item.code || item.c;\n\n        if (panel.loadingItem) panel.loadingItem = false;\n        panel.loadingItem = itemCode;\n\n        csd.loadData(item).then(function () {\n          if (panel.loadingItem == itemCode)\n            csd.refreshPanels(item.level + 1, item);\n        }, function () {\n          if (panel.loadingItem == itemCode)\n            itemEl.addClass('load-error');\n        }).always(function () {\n          if (panel.loadingItem == itemCode) {\n            panel.setItemOpened(item, itemEl);\n            panel.loadingItem = false;\n          }\n          itemEl.removeClass('bs-loading');\n        });\n      } else {\n        csd.refreshPanels(item.level + 1, item);\n        panel.setItemOpened(item, itemEl);\n        if (selectItem) panel.selectItem(item, itemEl);\n      }\n    };\n\n    panel.panelEl = $(TPLS.dropdownTpl).appendTo(csd.el), panel.data = data;\n\n    // set panel position\n    var lastPanel = csd.panels[csd.panels.length - 1];\n    if (lastPanel) {\n      var lastPanelEl = lastPanel.panelEl, lastPanelLeft = Number((lastPanelEl.css('left') || '').replace('px', ''));\n      panel.panelEl.css({left: lastPanelLeft + lastPanelEl.outerWidth()})\n    }\n    csd.panels.push(panel);\n\n    // update panel style\n    if (csd.panels.length > 0) {\n      csd.el.children('.dropdown-menu').removeClass('first-child last-child');\n      csd.panels[0].panelEl.addClass('first-child');\n      csd.panels[csd.panels.length - 1].panelEl.addClass('last-child');\n    }\n\n    var isParentAllMatched = false, hasMatchedChildren = false;\n    if (csd.selectedItems.length > data.level) isParentAllMatched = panel.isMatchedSelectedItems(data);\n\n    $.each(data.children, function (i, item) {\n      var itemEl = $(TPLS.dropdownItemTpl).appendTo(panel.panelEl), itemData = item.originData;\n      var itemName = itemData.name || itemData.n, itemCode = itemData.code || itemData.c;\n      itemEl.data(\"cascaderItem\", item).attr('code', itemCode).attr('title', itemName).find('.text').text(itemName);\n\n      itemEl.on({\n        'selectItem click': function () {\n          handler(item, itemEl, true);\n        },\n        'openDropdown': function () {\n          handler(item, itemEl);\n        }\n      });\n\n      if (csd.params.openOnHover) {\n        itemEl.on('mouseover', function () {\n          if (csd.openTimeout) clearTimeout(csd.openTimeout);\n          csd.openTimeout = setTimeout(function () {\n            handler(item, itemEl);\n          }, csd.params.lazy ? csd.params.openOnHoverDelay4Lazy : csd.params.openOnHoverDelay);\n        });\n      }\n\n      if (item.loaded && (!item.children || item.children.length <= 0)) itemEl.addClass('no-child');\n\n      // update selected items view state\n      if (csd.selectedItems.length >= item.level && isParentAllMatched) {\n        if (panel.isMatchedSelectedItems(item, false)) {\n          hasMatchedChildren = true;\n          if (csd.selectedItems.length > item.level) {\n            handler(item, itemEl, false);\n          } else {\n            if (csd.selectedItems.length == csd.panels.length)\n              $.each(csd.selectedItems, function (j, selectedItem) {\n                csd.panels[j].setSelected(selectedItem, j < csd.selectedItems.length - 1);\n              });\n            csd.inited(), csd.reloaded();\n          }\n        }\n      }\n    });\n\n    if ((!csd.isInited || csd.reloading) && csd.selectedItems.length > data.level && !hasMatchedChildren && csd.params.lazy)\n      csd.isInited ? csd.reloaded() : csd.inited();\n  };\n\n  // Cascader\n  var Cascader = function (params) {\n    var csd = this;\n    params = params || {};\n    for (var def in DEF_OPTS) if (typeof params[def] === 'undefined') params[def] = DEF_OPTS[def];\n    csd.params = params, csd.initialized = false, csd.selectedItems = [], csd.readonly = false;\n    if (csd.params.value instanceof Array) csd.selectedItems = [];\n\n    // initBtn\n    var initBtn = function () {\n      csd.btn = $(TPLS.btnTpl).addClass(params.btnCls).click(function () {\n        csd.open();\n      }).appendTo(csd.el);\n      csd.btn.children('.icon-cross').click(function (e) {\n        csd.clearValue(true);\n        e.preventDefault();\n        e.stopPropagation();\n      });\n      updateBtnText(params.placeHolder);\n    };\n\n    // convertData2Col\n    var convertData2Col = function (data, parent) {\n      var isLazy = csd.params.lazy;\n      $.each(data, function (i, item) {\n        var itemCode = item.code || item.c, children = item.data || item.d;\n        var itemData = {\n          childMap: {}, children: [], loaded: !isLazy || item.hasChild === false,\n          level: parent.level + 1, parent: parent, originData: item\n        };\n        parent.children.push(itemData);\n        parent.childMap[itemCode] = itemData;\n        if (children && children.length > 0) convertData2Col(children, itemData);\n      });\n    };\n\n    // updateBtnText\n    var updateBtnText = function (text) {\n      csd.btn.attr('title', text).children('.filter-option').text(text);\n      if (csd.getValue().length > 0) csd.btn.removeClass('bs-placeholder').addClass('selected');\n      else csd.btn.addClass('bs-placeholder').removeClass('selected');\n    };\n\n    // htmlClickHandler\n    var htmlClickHandler = function (e) {\n      if (!csd.el.hasClass('open')) return;\n      var cascader = $(e.target).parents('.bootstrap-cascader');\n      if (cascader.size() == 0) csd.close();\n      else if (cascader[0] != csd.el[0]) csd.close();\n    };\n\n    // setValue\n    csd.setValue = function (value) {\n      csd.clearValue();\n\n      var names = [], oldSelectedItems = csd.getValue;\n      $.each(value, function (i, item) {\n        csd.selectedItems.push({code: item.code || item.c, name: item.name || item.n});\n        names.push(item.name || item.n);\n      });\n      updateBtnText(names.join(csd.params.splitChar));\n      csd.updateViewBySelected();\n\n      csd.tryFireOnChange(oldSelectedItems, csd.getValue());\n    };\n\n    // refreshPanels\n    csd.refreshPanels = function (panelNo, data) {\n      var rmPanels = csd.panels.splice(panelNo - 1, csd.panels.length);\n      if (rmPanels) $.each(rmPanels, function (i, rmPanel) {\n        rmPanel.destroy();\n      });\n\n      new DropdownPanel(data, csd);\n    };\n\n    // destroy\n    csd.destroy = function () {\n      $.each(csd.panels, function (i, panel) {\n        panel.destroy();\n      });\n      $('html').off('click', htmlClickHandler);\n      csd.params.el.removeData(\"bsCascader\");\n    };\n\n    // selectItem\n    csd.selectItem = function (itemEl) {\n      csd.el.find('li a').removeClass('selected');\n      itemEl.children('a').addClass('selected');\n      csd.el.find('li.open a').addClass('selected');\n\n      var item = itemEl.data('cascaderItem'), names = [], oldSelectedItems = csd.getValue();\n      csd.selectedItems = [];\n      while (item.parent) {\n        var itemData = item.originData, code = itemData.code || itemData.c, name = itemData.name || itemData.n;\n        csd.selectedItems.unshift({code: code, name: name});\n        names.unshift(name);\n        item = item.parent;\n      }\n\n      updateBtnText(names.join(csd.params.splitChar));\n      csd.close();\n\n      var newItems = csd.getValue();\n      csd.tryFireOnChange(oldSelectedItems, newItems);\n      csd.params.el.trigger('bs.cascader.select', [newItems]);\n    };\n\n    // tryFireOnChange\n    csd.tryFireOnChange = function (oldItems, newItems) {\n      var fire = true;\n      if (oldItems != newItems && oldItems.length == newItems.length) {\n        var allCodesSame = true;\n        $.each(oldItems, function (i, oldItem) {\n          var oldItemCode = oldItem.code || oldItem.c, newItem = newItems[i], newItemCode = newItem.code || newItem.c;\n          if (oldItemCode != newItemCode) {\n            allCodesSame = false;\n            return false;\n          }\n        });\n        if (allCodesSame) fire = false;\n      }\n      if (fire) csd.params.el.trigger('bs.cascader.change', [oldItems, newItems]);\n    };\n\n    // close\n    csd.close = function () {\n      csd.el.removeClass('open');\n      csd.updateViewBySelected();\n    };\n\n    // update view by selected\n    csd.updateViewBySelected = function () {\n      if (csd.selectedItems.length > 0 && csd.panels.length > 0)\n        csd.panels[0].selectItemByCode(csd.selectedItems[0].code || csd.selectedItems[0].c);\n    };\n\n    // open\n    csd.open = function () {\n      if (csd.readonly) return;\n      csd.el.toggleClass('open');\n\n      $.each(csd.panels, function (i, panel) {\n        panel.scrollToOpened();\n      });\n    };\n\n    // getValue\n    csd.getValue = function () {\n      return csd.selectedItems.slice();\n    };\n\n    // clearValue\n    csd.clearValue = function (fire) {\n      if (csd.readonly) return;\n\n      csd.selectedItems = [];\n      csd.el.find('.dropdown-menu li a').removeClass('selected');\n      updateBtnText(csd.params.placeHolder);\n\n      if (fire) csd.params.el.trigger('bs.cascader.clear');\n    };\n\n    // setReadonly\n    csd.setReadonly = function (readonly) {\n      readonly = readonly !== false;\n      csd.readonly = readonly;\n      if (readonly) {\n        csd.el.addClass('readonly');\n        csd.btn.addClass('disabled');\n      } else {\n        csd.el.removeClass('readonly');\n        csd.btn.removeClass('disabled');\n      }\n    };\n\n    // isReadonly\n    csd.isReadonly = function () {\n      return csd.readonly;\n    };\n\n    // reload\n    csd.reload = function () {\n      csd.reloading = true, csd.data = {childMap: {}, children: [], loaded: false, level: 0};\n      csd.loadData().then(function () {\n        csd.refreshPanels(1, csd.data);\n        if (csd.params.value) csd.setValue(csd.params.value);\n        if (!csd.params.lazy || !csd.params.value) csd.reloaded();\n      });\n    };\n\n    // reloaded\n    csd.reloaded = function () {\n      if (!csd.reloading) return;\n\n      csd.reloading = false;\n      csd.params.el.trigger('bs.cascader.reloaded');\n    };\n\n    // inited\n    csd.inited = function () {\n      if (csd.isInited) return;\n\n      csd.isInited = true;\n      csd.params.el.trigger('bs.cascader.inited');\n    };\n\n    // loadData\n    csd.loadData = function (item) {\n      // get opened items\n      var openedItems = [];\n      if (item) {\n        var currItem = item;\n        while (currItem.parent) {\n          openedItems.unshift(currItem.originData);\n          currItem = currItem.parent;\n        }\n      } else item = csd.data;\n\n      var defered = $.Deferred();\n      csd.params.loadData.call(csd, openedItems, function (data) {\n        if (data) {\n          if (data.length > 0) {\n            if (!openedItems || openedItems.length <= 0) csd.data.originData = data;\n            convertData2Col(data, item);\n          }\n          item.loaded = true;\n          defered.resolve(data);\n        } else defered.reject();\n      });\n      return defered.promise();\n    };\n\n    csd.data = {childMap: {}, children: [], loaded: false, level: 0}, csd.panels = [];\n    csd.cols = [], csd.el = $(TPLS.containerTpl).addClass(csd.params.cls);\n    if (csd.params.dropUp) csd.el.addClass('dropup');\n    if (csd.params.replace) {\n      csd.el.insertAfter(params.el);\n      params.el.hide();\n    } else csd.el.appendTo(params.el);\n    initBtn();\n    if (csd.params.readonly) csd.setReadonly(true);\n\n    csd.loadData().always(function () {\n      csd.refreshPanels(1, csd.data);\n      if (csd.params.value) csd.setValue(csd.params.value);\n      if (!csd.params.lazy || !csd.params.value) csd.inited();\n    });\n\n    $('html').on('click', htmlClickHandler);\n  };\n\n  $.fn.bsCascader = function (params) {\n    var args = arguments;\n    return this.each(function () {\n      if (!this) return;\n      var $this = $(this);\n\n      var bsCascader = $this.data(\"bsCascader\");\n      if (!bsCascader) {\n        params = $.extend({\n          el: $this, value: $this.val() ? $this.val().split(params.splitChar || ' ') : ''\n        }, params);\n        bsCascader = new Cascader(params);\n        $this.data(\"bsCascader\", bsCascader);\n      }\n      if (typeof params === typeof \"a\")\n        bsCascader[params].apply(bsCascader, Array.prototype.slice.call(args, 1));\n    });\n  }\n\n})(jQuery);\n"]}